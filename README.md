# üìö Library API ‚Äî –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ (Python FastAPI)

REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ —Å—Ç–∞–∂–∏—Ä–æ–≤–∫—É Python-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞.

---

## üöÄ –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- Python 3.11
- FastAPI
- SQLAlchemy
- Alembic
- Pydantic
- SQLite (–∏–ª–∏ PostgreSQL)
- Pytest

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

#### 1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
- git clone ...
- cd library_api
   
#### 2. –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª –∏ —É–∫–∞–∂–∏—Ç–µ:
- DATABASE_URL=postgresql+psycopg2://postgres:admin@localhost:5432/library_db
- SECRET_KEY=your_secret_key
- **–í–∞–∂–Ω–æ**: —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤—ã—à–µ ‚Äî –ø—Ä–∏–º–µ—Ä. –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `.env`. –î–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è.

#### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- pip install -r requirements.txt


#### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
- alembic upgrade head


#### 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:
- uvicorn app.main:app --reload


#### 6. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:
- [http://localhost:8000/docs](http://localhost:8000/docs)

---

## üìå –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

- **4.1** ‚Äî –∫–Ω–∏–≥—É –º–æ–∂–Ω–æ –≤—ã–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `copies > 0`. –ü—Ä–∏ –≤—ã–¥–∞—á–µ ‚Äî `copies -= 1`.
- **4.2** ‚Äî –æ–¥–∏–Ω —á–∏—Ç–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –¥–µ—Ä–∂–∞—Ç—å –±–æ–ª–µ–µ 3-—Ö –∫–Ω–∏–≥ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `return_date is NULL`)
- **4.3** ‚Äî –Ω–µ–ª—å–∑—è –≤–µ—Ä–Ω—É—Ç—å –∫–Ω–∏–≥—É, –µ—Å–ª–∏:
   - –æ–Ω–∞ —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞;
   - –æ–Ω–∞ –Ω–µ –±—ã–ª–∞ –≤—ã–¥–∞–Ω–∞ —ç—Ç–æ–º—É —á–∏—Ç–∞—Ç–µ–ª—é.

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å email/password
- –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ (`passlib[bcrypt]`)
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ JWT (`python-jose`)
- –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –∫—Ä–æ–º–µ `/login` –∏ `/register`, –∑–∞—â–∏—â–µ–Ω—ã JWT
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Depends(get_current_user)`

---

## üìò –û—Ç–∫—Ä—ã—Ç–æ—Å—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ `/books`

–≠–Ω–¥–ø–æ–∏–Ω—Ç `GET /books` —Å–¥–µ–ª–∞–Ω –ø—É–±–ª–∏—á–Ω—ã–º ‚Äî –ª—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏, –Ω–µ –≤—Ö–æ–¥—è –≤ —Å–∏—Å—Ç–µ–º—É.

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏—á–∞

**–ò–¥–µ—è:** –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–∫–∏/—Ç–µ–≥–∏ –∫ –∫–Ω–∏–≥–∞–º (–∂–∞–Ω—Ä—ã, —Ç–µ–º–∞—Ç–∏–∫–∞).

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `tags` + —Å–≤—è–∑—É—é—â–∞—è `book_tags`
- –≠–Ω–¥–ø–æ–∏–Ω—Ç: `GET /books?tag=—Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞` ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å —Ç–µ–≥–∏ –∫ –∫–Ω–∏–≥–µ —á–µ—Ä–µ–∑ PATCH

–≠—Ç–æ —É–ª—É—á—à–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç –∏ –ø–æ–º–æ–∂–µ—Ç –∏—Å–∫–∞—Ç—å –∫–Ω–∏–≥–∏ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º.

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- –¢–µ—Å—Ç –Ω–∞ –∑–∞—â–∏—Ç—É JWT
- –ù–µ–ª—å–∑—è –≤–∑—è—Ç—å –∫–Ω–∏–≥—É, –µ—Å–ª–∏ `copies == 0`
- –ù–µ–ª—å–∑—è –≤–∑—è—Ç—å 4 –∫–Ω–∏–≥–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏–∏
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Alembic. –ú–∏–≥—Ä–∞—Ü–∏–∏:

‚úÖ –ù–∞—á–∞–ª—å–Ω–∞—è (—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü)

‚úÖ –í—Ç–æ—Ä–∞—è: –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ description –≤ –º–æ–¥–µ–ª—å Book

---

## üí° –ü—Ä–∏–Ω—è—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- GET /books –≤—ã–±—Ä–∞–Ω –ø—É–±–ª–∏—á–Ω—ã–º ‚Äî —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–≥ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏ –ø–µ—Ä–µ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π

- –ü—Ä–æ–≤–µ—Ä–∫–∏ (3 –∫–Ω–∏–≥–∏, copies, JWT) –≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É

- –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö Pydantic —á–µ—Ä–µ–∑ **.dict() —É–ø—Ä–æ—â–∞–µ—Ç –∫–æ–¥

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
app/
‚îú‚îÄ‚îÄ api/           # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îú‚îÄ‚îÄ models/        # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ schemas/       # Pydantic-—Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ crud/          # –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚îú‚îÄ‚îÄ core/          # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îú‚îÄ‚îÄ db/            # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ tests/         # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
```
---

## üß¨ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

- `users`: –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä–∏ (—Å email, hashed_password)
- `books`: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–∏–≥–∞—Ö
- `readers`: —á–∏—Ç–∞—Ç–µ–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
- `borrowed_books`: —Å–≤—è–∑—å —á–∏—Ç–∞—Ç–µ–ª–µ–π —Å –∫–Ω–∏–≥–∞–º–∏, –ø–æ–ª–µ `return_date` ‚Äî —Ñ–∞–∫—Ç –≤–æ–∑–≤—Ä–∞—Ç–∞

---

### **–í—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ —Ä–∞–º–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ Python-—Å—Ç–∞–∂–∏—Ä–æ–≤–∫—É**
üêç **–ì–æ—Ç–æ–≤ —É—á–∏—Ç—å—Å—è, —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è –∏ –ø–∏—Å–∞—Ç—å —á–∏—Å—Ç—ã–π –∫–æ–¥**
